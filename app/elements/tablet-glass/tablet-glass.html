<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<polymer-element name="tablet-glass" attributes="lightness">
	<template>
		<link rel="stylesheet" href="tablet-glass.css">
		<core-range min="0" max="255" value="{{lightness}}" ratio="{{ratio}}"></core-range>
		<div class="tablet-glass-wrapper">
			<div class="lightness-selector-bg">
				<div class="lightness-selector" on-down="{{selectorClick}}" style="opacity:{{ratio/100}};">
			</div>
			</div>
			<div class="elements">
				<button raised class="setMin" on-click="{{setMin}}">0</button>
				<input class="lightness" value="{{lightness}}"/>
				<button raised class="setMax" on-click="{{setMax}}">255</button>

			</div>
		</div>
	</template>
	<script>

		Polymer('tablet-glass', {
			ready: function () {
				var that = this;
				this.selectorClick = function(e) {
					e.preventDefault();
					var y = getClickPosition(e);

					function getClickPosition(e) {
						var parentPosition = getPosition(e.currentTarget);
						var xPosition = e.clientX - parentPosition.x;
						var yPosition = e.target.clientHeight - (e.clientY - parentPosition.y);
						that.lightness = Math.round((yPosition / e.target.clientHeight) * 255);
						that.setAttribute('lightness',Math.round((yPosition / e.target.clientHeight) * 255));
					}

					function getPosition(element) {
						var xPosition = 0;
						var yPosition = 0;

						while (element) {
							xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);
							yPosition += (element.offsetTop - element.scrollTop + element.clientTop);
							element = element.offsetParent;
						}
						return { x: xPosition, y: yPosition };
					}
				},
				this.setMin = function() {
					that.lightness = 0;
				},
				this.setMax = function() {
					that.lightness = 255;
				}
			}
		});

	</script>
</polymer-element>
